var randList,intervalID,timeInterval,pace,playflag,max=90,min=1,current=0,isMute=0,doAnnounce=1,playButton=document.getElementById("play"),pauseButton=document.getElementById("pause"),resetButton=document.getElementById("reset"),muteButton=document.getElementById("mute"),unmuteButton=document.getElementById("unmute"),generateButton=document.getElementById("manual-generate"),autoGenerateButton=document.getElementById("auto-generate"),manualResetButton=document.getElementById("manual-reset"),generateSection=document.getElementById("generate"),speedupButton=document.getElementById("speedup"),slowdownButton=document.getElementById("slowdown");function displayBoard(){for(var e=document.getElementById("tambola-board"),t=0;t<max;t++){var n=document.createElement("div"),a=t+1;n.setAttribute("id","num-"+a),n.setAttribute("class","box"),n.appendChild(document.createTextNode(a)),e.appendChild(n)}sessionStorage.getItem("lastIndex")>0&&(document.getElementById("resume-restart").style.display="block",generateSection.style.display="None")}function resume(){sessionGameGenerator(),generateSection.style.display="none",document.getElementById("play-btns").style.display="flex",document.getElementById("resume-restart").style.display="none"}function sessionGameGenerator(){var e=Number(sessionStorage.getItem("lastIndex"));timeInterval=Number(sessionStorage.getItem("lastTimeInterval")),randList=sessionStorage.getItem("randomList").split(","),doAnnounce=0;for(var t=0;t<=e-1;t++)getNext();doAnnounce=1,intervalID=setInterval(getNext,timeInterval),toggle()}function restart(){generateSection.style.display="block",document.getElementById("resume-restart").style.display="none",sessionStorage.lastIndex=0,sessionStorage.removeItem("randomList"),sessionStorage.removeItem("lastTimeInterval")}function announceText(e){if(1!=isMute){const t=window.speechSynthesis,n=new SpeechSynthesisUtterance(e);t.speak(n)}}function showNum(e){var t=document.getElementById("show-num");t.innerText=e,t.style.visibility="visible"}function generateNum(){autoGenerateButton.style.display="none",generateButton.innerText="Next",document.getElementById("manual-reset").style.display="flex",0==current&&(randList=RandomList(min,max)),getNext()}function autoGenerateNum(){randList=RandomList(min,max),document.getElementById("pace-section").style.display="flex",generateSection.style.display="none"}function slowGenerator(){setTimeInterval(pace=1),intervalID=setInterval(getNext,timeInterval),toggle()}function mediumGenerator(){setTimeInterval(pace=2),intervalID=setInterval(getNext,timeInterval),toggle()}function fastGenerator(){setTimeInterval(pace=3),intervalID=setInterval(getNext,timeInterval),toggle()}function setTimeInterval(e){switch(e){case 1:timeInterval=6e3,slowdownButton.style.visibility="hidden",speedupButton.style.visibility="visible";break;case 2:timeInterval=3500,slowdownButton.style.visibility="visible",speedupButton.style.visibility="visible";break;case 3:timeInterval=2e3,slowdownButton.style.visibility="visible",speedupButton.style.visibility="hidden"}}function speedup(){pace<3&&(pace+=1,clearInterval(intervalID),setTimeInterval(pace),play&&(intervalID=setInterval(getNext,timeInterval)))}function slowdown(){pace>0&&(pace-=1,clearInterval(intervalID),setTimeInterval(pace),play&&(intervalID=setInterval(getNext,timeInterval)))}function toggle(){generateButton.disabled=!0,document.getElementById("pace-section").style.display="none",document.getElementById("play-btns").style.display="flex"}function play(){playflag=1,intervalID=setInterval(getNext,timeInterval),pauseButton.style.display="inline-block",playButton.style.display="none"}function pause(){playflag=0,clearInterval(intervalID),pauseButton.style.display="none",playButton.style.display="inline-block"}function manualReset(){1==confirm("Are you sure, you want to reset game?")&&(document.getElementById("show-num").style.visibility="hidden",current=0)}function reset(){clearInterval(intervalID),1==confirm("Are you sure, you want to reset game?")&&(sessionStorage.clear(),document.getElementById("tambola-board").innerHTML="",document.getElementById("play-btns").style.display="none",document.getElementById("show-num").style.visibility="hidden",generateSection.style.display="flex",document.getElementById("resume-restart").style.display="none",generateButton.disabled=!1,pauseButton.style.display="inline-block",playButton.style.display="none",displayBoard(),generateButton.innerText="Generate",autoGenerateButton.style.display="flex",manualResetButton.style.display="none",current=0)}function mute(){isMute=1,muteButton.style.display="none",unmuteButton.style.display="inline-block"}function unmute(){isMute=0,muteButton.style.display="inline-block",unmuteButton.style.display="none"}function getNext(){if(console.log("Getting next"),current<max){var e=randList[current],t=document.getElementById("num-"+e);if(t.classList.add("current"),1==doAnnounce&&(announceText(t.textContent),showNum(t.textContent)),current>0){var n=randList[current-1],a=document.getElementById("num-"+n);a.classList.contains("current")?a.classList.replace("current","generated"):a.classList.add("generated")}current+=1}current===max&&clearInterval(intervalID)}function RandomList(e,t){randomArray=[];for(let n=0;n<t;n++)x=Math.floor(Math.random()*t)+e,1==randomArray.includes(x)?n-=1:randomArray.push(x);return randomArray}window.onload=displayBoard,window.onbeforeunload=()=>(pause(),sessionStorage.setItem("lastIndex",current),sessionStorage.setItem("randomList",randList),sessionStorage.setItem("lastTimeInterval",timeInterval),document.getElementById("resume-restart").style.display="block",document.getElementById("play-btns").style.display="none",!1);